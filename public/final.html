<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Create | Postcard Zappar</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"
      integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <link rel="stylesheet" href="styles/create.css" />
  </head>

  <body>
    
    <video width="320" height="240" controls autoplay muted id="videoId"  class="fullsc" loop="true">
      <source src="./assets/postcardvid.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>

<div class="design" style="display: block;">
  <h1>YOUR DESIGNED AR POSTCARD</h1>
<P class="subtitle">to send to your loved ones</P>

<center><input type="text" name="add" id="inp" class="note" placeholder="add note"> <button onclick="document.getElementById('noteplace').innerHTML = document.getElementById('inp').value">Add</button>
</center>
<div class="post-par"><div id="posty" class="postcard">
  <!-- <img src="https://api.qrserver.com/v1/create-qr-code/?data=HelloWorld&amp;size=100x100" alt="" title="HELLO"  class="postcard-qr"  /> -->
  <canvas id="qr-code"></canvas>  <!-- <img src="https://media.discordapp.net/attachments/873911460055642152/1060903835121483817/EAAAAASUVORK5CYII.png" class="postcard-qr" alt=""> -->
  <p class="coderoom" style="margin-top: -0.3rem; margin-bottom: -0.3rem;" id="coderoom">code</p>
  <p class="postcard-title">AR Postcard</p>
  <p class="postcard-subtitle">made especially for you</p>
  <p style="margin-top: -1rem; font-size: 1rem;">powered by ZapWorks</p>
  <div class="mascot1">
<p class="noteplace" id="noteplace" style="text-align: center;">change this text using input box</p>

  </div>
  <!-- <img src="https://i.pinimg.com/originals/ae/bf/f8/aebff820fd4da79db61299c3ac69bd9a.png" class="mascot1" alt=""> -->
  <!-- <img src="https://www.freepnglogos.com/uploads/mascot-logo-png/bear-head-mascot-red-bear-mascot-angry-15.png" class="mascot2" alt=""> -->
</div></div>

<center><button class="next" onclick="save()">download</button></center>
</div>

   
    <a id="link"></a>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>

    <script>


var x = localStorage.getItem("hex");
var y = localStorage.getItem("textclr");
document.getElementById("posty").style.color = y;

var clr = localStorage.getItem("clr");
document.getElementById("posty").style.backgroundColor = x;
var isTexture = localStorage.getItem("isTexture");
var code = localStorage.getItem("code");

document.getElementById("coderoom").innerHTML = 'code: '+code;


if(isTexture){
  console.log("hemlo")
  document.getElementById("posty").style.backgroundImage = 'url("./assets/'+clr+'.png")'
}

// document.getElementById


// ("mascotchild").style.backgroundColor = x
var qrtext = "https://8nqe6.zappar.io/2373053848413461853/1.0.1/scan.html?code="+code;
                // document.getElementById("qr-result").innerHTML = "QR code for " + qrtext +":";
                // alert(qrtext);
                var qr;
			(function() {
                    qr = new QRious({
                    element: document.getElementById('qr-code'),
                    size: 150,
                    value: qrtext
                });
            })();
            

      function save() {

        html2canvas(
          document.querySelector("#posty")).then((canvas) => {
            // allowTaint: true
          
          // document.body.appendChild(canvas)
          var link = document.getElementById("link");
          link.setAttribute("download", "postcard.png");
          link.setAttribute(
            "href",
            canvas
              .toDataURL("image/png")
              .replace("image/png", "image/octet-stream")
          );
          link.click();
        });
      }

  
    </script>
  </body>
</html>
